Coreografia :== (
                    CoreografiaRichiestaMenu |
                    CoreografiaOrdine |
                    ModificaInformazioniLocali
                )

CoreografiaRichiestaMenu :==    ( 
                                    SelezioneComune : Cliente -> ACMEat ;
                                    InvioListaLocali : ACMEat -> Cliente
                                )

CoreografiaOrdine :==   (
                            Ordine : Cliente -> ACMEat ;
                            Richiesta disponibilità ristorante : ACMEat -> Ristorante ;
                            // Disponibile ?
                            (
                                // No
                                Annullamento procedura : ACMEat -> Cliente
                            ) + (
                                // Sì
                                ( Richiesta disponibilità SDS : ACMEat -> SDS )* ;
                                // Lista vuota ?
                                (
                                    // Sì
                                    AnnullamentoC : ACMEat -> Cliente |
                                    AnnullamentoR : ACMEat -> Ristorante ;
                                ) + (
                                    // No
                                    Contatta SDS costo minore: ACMEat -> SDS ;
                                    CreazioneRichiestaPagamento: ACMEat -> Banca ;
                                    ConfermaCreazioneTransazione: Banca -> ACMEat ;
                                    RedirezionePagamento: ACMEat -> Cliente ;

                                    // Modellazione timeout ???
                                    
                                    Pagamento : Cliente -> Banca;
                                    InvioTokenC : Banca -> Cliente;
                                    InvioTokenA : Cliente -> ACMEat ;
                                    RichiestaValidità : ACMEat -> Banca ;
                                    ValiditàToken : Banca -> ACMEat ;
                                    // Token valido ?
                                    (
                                        // No
                                        ErrorePagamento: ACMEat -> Cliente   |
                                        AnnullamentoR : ACMEat -> Ristorante |
                                        AnnullamentoS : ACMEat -> SDS        |
                                    ) + (
                                        // Sì
                                        AttivazioneOrdineR : ACMEat -> Ristorante |
                                        AttivazioneOrdineS : ACMEat -> SDS        |
                                        ConfermaOrdine: ACMEat -> Cliente ;

                                        // Manca meno di un'ora ?
                                        (
                                            // No
                                            // Annullare ?
                                            (
                                                // Sì
                                                AnnullamentoOrdine: Cliente -> ACMEat ;
                                                (
                                                    AnnullamentoPagamento: ACMEat -> Banca;
                                                    Rimborso: Banca -> Cliente;
                                                ) |
                                                AnnullamentoR : ACMEat -> Ristorante |
                                                AnnullamentoS : ACMEat -> SDS
                                            ) + (
                                                // No
                                                1
                                            )
                                        ) + (
                                            // Sì
                                            (
                                                PagamentoR : ACMEat -> Banca;
                                                RicezionePagamentoR : Banca -> Ristorante;
                                            ) |
                                            (
                                                PagamentoS : ACMEat -> Banca;
                                                RicezionePagamentoS : Banca -> SDS ;
                                            ) |
                                            (
                                                ConsegnaMerceF : Ristorante -> Fattorino ;
                                                ConcegnaMerceC : Fattorino -> Cliente;
                                            )
                                        )

                                        /*
                                        (
                                            // Annullamento ordine
                                            AnnullamentoOrdine: Cliente -> ACMEat ;
                                            AnnullamentoPagamento: ACMEat -> Banca |
                                            AnnullamentoR : ACMEat -> Ristorante |
                                            AnnullamentoS : ACMEat -> SDS
                                        ) + (
                                            // Manca un'ora
                                            (
                                                PagamentoR : ACMEat -> Banca;
                                                RicezionePagamentoR : Banca -> Ristorante;
                                            ) |
                                            (
                                                PagamentoS : ACMEat -> Banca;
                                                RicezionePagamentoS : Banca -> SDS ;
                                            ) |
                                            (
                                                ConsegnaMerceF : Ristorante -> Fattorino ;
                                                ConcegnaMerceC : Fattorino -> Cliente;
                                            )
                                        )
                                        */
                                        
                                    )
                                )
                            )
                        )

ModificaInformazioniLocali :==  (
                                    RichiestaAggiornamento : Ristorante -> ACMEat ;
                                    // Prima delle 10 ?
                                    (
                                        // No
                                        richiestaRifiutata : ACMEat -> Ristorante
                                    ) + (
                                        // Sì
                                        richiestaAccettata : ACMEat -> Ristorante
                                    )
                                )