Coreografia :== (
                    CoreografiaRichiestaMenu |
                    CoreografiaOrdine |
                    ModificaInformazioniLocali
                )

CoreografiaRichiestaMenu :==    ( 
                                    SelezioneComune : Cliente -> ACMEat ;
                                    InvioListaLocali : ACMEat -> Cliente
                                )

CoreografiaOrdine :==   (
                            Ordine : Cliente -> ACMEat ;
                            Richiesta disponibilità ristorante : ACMEat -> Ristorante;
                            DisponibilitàR: Ristorante -> ACMEat;
                            // Disponibile ?
                            (
                                // No
                                Annullamento procedura : ACMEat -> Cliente
                            ) + (
                                // Sì
                                ( 
                                    Richiesta disponibilità SDS : ACMEat -> SDS;
                                    ( //In 15 secondi 
                                        PreventivoDisponibilità: SDS -> ACMEat +
                                        1
                                    )
                                )* ;
                                // Lista vuota ?
                                (
                                    // Sì
                                    AnnullamentoC : ACMEat -> Cliente |
                                    AnnullamentoR : ACMEat -> Ristorante ;
                                ) + (
                                    // No
                                    Contatta SDS costo minore: ACMEat -> SDS ;
                                    ACK: SDS -> ACMEat;
                                    CreazioneRichiestaPagamento: ACMEat -> Banca ;
                                    ConfermaCreazioneTransazione: Banca -> ACMEat ;
                                    RedirezionePagamento: ACMEat -> Cliente ;

                                    // Modellazione timeout 
                                    (
                                        Pagamento : Cliente -> Banca;
                                        InvioTokenC : Banca -> Cliente;
                                        InvioTokenA : Cliente -> ACMEat ;
                                        RichiestaValidità : ACMEat -> Banca ;
                                        ValiditàToken : Banca -> ACMEat ;
                                        // Token valido ?
                                        (
                                            // No
                                            ErrorePagamento: ACMEat -> Cliente   |
                                            AnnullamentoR : ACMEat -> Ristorante |
                                            AnnullamentoS : ACMEat -> SDS        |
                                        ) + (
                                        // Sì
                                        AttivazioneOrdineR : ACMEat -> Ristorante |
                                        AttivazioneOrdineS : ACMEat -> SDS        |
                                        ConfermaOrdine: ACMEat -> Cliente ;

                                        // Manca meno di un'ora ?
                                        (
                                            // No
                                            // Annullare ?
                                            (
                                                // Sì
                                                AnnullamentoOrdine: Cliente -> ACMEat ;
                                                (
                                                    AnnullamentoPagamento: ACMEat -> Banca;
                                                    Rimborso: Banca -> Cliente;
                                                ) |
                                                (
                                                    AnnullamentoR : ACMEat -> Ristorante;
                                                    RicevutoAnnullamento: Ristorante -> ACMEat;
                                                ) |
                                                (
                                                    AnnullamentoS : ACMEat -> SDS;
                                                    RicevutoAnnullamento: SDS -> ACMEat;
                                                )
                                            ) + (
                                                // No
                                                1
                                            )
                                        ) + (
                                            // Sì
                                            (
                                                PagamentoR : ACMEat -> Banca;
                                                RicezionePagamentoR : Banca -> Ristorante;
                                            ) |
                                            (
                                                PagamentoS : ACMEat -> Banca;
                                                RicezionePagamentoS : Banca -> SDS ;
                                            ) |
                                            (
                                                ConsegnaMerceF : Ristorante -> Fattorino ;
                                                ConcegnaMerceC : Fattorino -> Cliente;
                                                ConfermaRicevutaSpedizione: Fattorino -> ACMEat;
                                            )
                                        )
                                    ) + (
                                        //Scadenza timer
                                        ErrorePagamento: ACMEat -> Cliente |
                                        (
                                            Annullamento: ACMEat -> Ristorante;
                                            RicevutoAnnullamento: Ristorante -> ACMEat;    
                                        ) |
                                        (
                                        Annullamento: ACMEat -> Corriere ;
                                        RicevutoAnnullamento: Corriere -> ACMEat;
                                        )
                                    )
                                )
                            )
                        )

ModificaInformazioniLocali :==  (
                                    RichiestaAggiornamento : Ristorante -> ACMEat ;
                                    // Prima delle 10 ?
                                    (
                                        // No
                                        RichiestaRifiutata : ACMEat -> Ristorante
                                    ) + (
                                        // Sì
                                        RichiestaAccettata : ACMEat -> Ristorante
                                    )
                                )